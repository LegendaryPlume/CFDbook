(window.webpackJsonp=window.webpackJsonp||[]).push([[231],{564:function(a,s,t){"use strict";t.r(s);var e=t(12),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"_1-命令简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-命令简介"}},[a._v("#")]),a._v(" 1.命令简介")]),a._v(" "),s("p",[a._v("ssh-keygen 是 OpenSSH 身份验证密钥实用工具。")]),a._v(" "),s("p",[a._v("ssh-keygen 用于 OpenSSH 身份验证密钥的生成、管理和转换，它支持 RSA 和 DSA 两种认证密钥。")]),a._v(" "),s("h2",{attrs:{id:"_2-命令格式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-命令格式"}},[a._v("#")]),a._v(" 2.命令格式")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ssh-keygen "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("OPTIONS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" FILE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n")])])]),s("h2",{attrs:{id:"_3-选项说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-选项说明"}},[a._v("#")]),a._v(" 3.选项说明")]),a._v(" "),s("p",[a._v("下面只列出常用的选项，更多选项可参考手册。")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-b")]),a._v(" BITS\n\t指定密钥长度。\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v("\n\t读取私有或公共 OpenSSH 密钥文件并以 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" 选项指定的格式之一将密钥打印到标准输出。\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-C")]),a._v("\n\t添加注释。\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" FILENAME\n\t指定用来保存密钥的文件名。\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v("\n\t以 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" 选项指定的格式读取未加密的私钥（或公钥）文件，并将 OpenSSH 兼容的私钥（或公钥）打印到 stdout。\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-l")]),a._v("\n\t显示公钥文件的指纹数据。\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" KEY_FORMAT\n\t为 -i（导入）或 -e（导出）转换选项指定密钥格式。支持的密钥格式为：“RFC4716”（RFC "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4716")]),a._v("/SSH2 公钥或私钥）、“PKCS8”（PEM PKCS8 公钥）或“PEM”（PEM 公钥）。 默认转换格式为“RFC4716”。\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-N")]),a._v("\n\t提供一个新密语。\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-P")]),a._v(" PASSPHRASE\n\t提供（旧）密语。\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-q")]),a._v("\n\t静默模式。\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v("\n\t指定要创建的密钥类型。可能的值为“dsa”、“ecdsa”、“ecdsa-sk”、“ed25519”、“ed25519-sk”或“rsa”。\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v("\n\t从 OpenSSH 格式的私钥导出公钥。\n")])])]),s("h2",{attrs:{id:"_4-常用示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-常用示例"}},[a._v("#")]),a._v(" 4.常用示例")]),a._v(" "),s("p",[a._v("（1）创建一个默认密钥，缺省为 RSA 类型的密钥。")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ssh-keygen\nGenerating public/private rsa key pair.\nEnter "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("which")]),a._v(" to save the key "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("/home/lighthouse/.ssh/id_rsa"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(": \nEnter passphrase "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("empty "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" no passphrase"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(": \nEnter same passphrase again: \nYour identification has been saved "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" /home/lighthouse/.ssh/id_rsa.\nYour public key has been saved "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" /home/lighthouse/.ssh/id_rsa.pub.\nThe key fingerprint is:\nSHA256:c8jkpkXgRqqfelFHKxq956d+6qYzAR0kHgnaVs9gtYw lighthouse@VM-0-3-centos\nThe key's randomart image is:\n+---"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("RSA "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2048")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("----+\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("*"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+=")]),a._v("          "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" o +.%.o.        "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v(" o EoBoo.       "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v(" .o."),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v("o.       "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" +S "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("      "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("   .o.o+.o       "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("    o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("+         "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(" o o o      "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("  .B"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v("       "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n+----"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("SHA256"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("-----+\n")])])]),s("p",[a._v("中途需要三次确认，全部缺省直接回车即可。")]),a._v(" "),s("p",[a._v("完成后，在 ~/.ssh 目录下将会看到两个文件：")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("ls -l ~/.ssh\nid_rsa  id_rsa.pub\n")])])]),s("p",[a._v("id_rsa 为当前主机的私钥。id_rsa.pub 为当前主机的公钥。")]),a._v(" "),s("p",[a._v("（2）指定要创建的密钥类型，缺省为 RSA。")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ssh-keygen "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" rsa\n")])])]),s("p",[a._v("（3）指定密钥的类型并添加注释。")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ssh-keygen "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" rsa "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-C")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"dablelv@qq.com"')]),a._v("\n")])])]),s("p",[a._v("（4）读取 OpenSSH 的私钥或者公钥文件。")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ssh-keygen "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v("\n---- BEGIN SSH2 PUBLIC KEY ----\nComment: "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"2048-bit RSA, converted by lighthouse@VM-0-3-centos from Ope"')]),a._v("\nAAAAB3NzaC1yc2EAAAADAQABAAABAQDb1aKBbvfSefnuzLfhNKlIa4zsbBFG+m7ugZbeBW\nRwJXONhSq/AW27+Tq9zDtI6qG+UxmjIorVHbAVl4llVZz8e5b/s5I0yiBoLy/RokpvisNB\nkVkWl2oNGtkdHxTSYcJ3jdbTZ+ya6MyOiaMt24jV+zxxS1BXWxA14kS/JqiMC7lx9Vu0Ed\nAHY0zq2dj+pX31FB7Xs7p98eO+Est6msCGIInIpzGTlTskL6m7B+aMBaquWlEyQAmRX5G8\nYoOFw+aDT4q1aaaaBkFdcy/nhHPpbfM8eIzbAv+khHRjZV8XQCo+UeHzme8nmfWDCWwKZ8\nTnpO239diTdl2Wps2YCMex\n---- END SSH2 PUBLIC KEY ----\n")])])]),s("p",[a._v("（5）安静模式生成密钥对。")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ssh-keygen "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-q")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" rsa\nEnter "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("which")]),a._v(" to save the key "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("/home/lighthouse/.ssh/id_rsa"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(": \n/home/lighthouse/.ssh/id_rsa already exists.\nOverwrite "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("y/n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("? y\nEnter passphrase "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("empty "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" no passphrase"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(": \nEnter same passphrase again:\n")])])]),s("p",[a._v("（6）从私钥导出公钥。")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ssh-keygen "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("-f PRV_KEY_FILE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])])]),s("p",[a._v("如果不通过 -f 选项指定私钥文件，则以交互方式指定。")]),a._v(" "),s("p",[a._v("（7）将 OpenSSH 格式公钥转换成 OpenSSL 的 PKCS#1 格式公钥。")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ssh-keygen "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" PEM "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" id_rsa.pub "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" rsa_pub_key.pem\n")])])]),s("p",[a._v("（8）将 OpenSSL 的 PKCS#8 格式公钥转换成 OpenSSH 的格式公钥。")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ssh-keygen "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" PKCS8 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" rsa_pub_key.pem "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" id_rsa.pub\n")])])]),s("h2",{attrs:{id:"_5-authorized-keys-和-known-hosts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-authorized-keys-和-known-hosts"}},[a._v("#")]),a._v(" 5.authorized_keys 和 known_hosts")]),a._v(" "),s("p",[a._v("有时，你在 ~/.ssh 目录下可能还会看到 authorized_keys 和 known_hosts 这两个文件。")]),a._v(" "),s("ul",[s("li",[a._v("authorized_keys")])]),a._v(" "),s("p",[a._v("如果当前主机是 SSH 服务端，那么会有 authorized_keys，用来存放客户端机器的公钥。")]),a._v(" "),s("p",[a._v("我们需要本地机器通过 SSH 访问远程服务器时为了减少输入密码的步骤，基本上都会在本地机器生成 SSH 公钥，然后将本地 SSH 公钥复制到远程主机的 ~/.ssh/authorized_keys 中，这样就可以免密登录了。")]),a._v(" "),s("ul",[s("li",[a._v("known_hosts")])]),a._v(" "),s("p",[a._v("如果当前主机为 SSH 客户端，你可能会在 ~/.ssh 目录下看到 known_hosts 文件，该文件用来记录连接过的远程主机。")]),a._v(" "),s("p",[a._v("known_hosts 文件每行记录一个连接过的远程服务器的公钥。")]),a._v(" "),s("p",[a._v("文件中的每一行都包含以下字段："),s("strong",[a._v("标记符(可选)、主机名、公钥类型、base64 编码的公钥、注释")]),a._v("。字段之间用空格分隔。")]),a._v(" "),s("p",[a._v("如果是首次连接某个远程主机，那么会有安全提示是否继续连接。")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("The authenticity of "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("host")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'0.0.0.0 (0.0.0.0)'")]),a._v(" can't be established.\nECDSA key fingerprint is SHA256:xxxxxxxxxxxx.\nAre you sure you want to "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("continue")]),a._v(" connecting "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("yes/no/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("fingerprint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("?\n")])])]),s("p",[a._v("另外，在 /etc/ssh 目录下也可能会有 ssh_known_hosts 来保存一些对所有用户都可信赖的远程主机信息。")]),a._v(" "),s("hr"),a._v(" "),s("h2",{attrs:{id:"参考文献"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考文献"}},[a._v("#")]),a._v(" 参考文献")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://man7.org/linux/man-pages/man1/ssh-keygen.1.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("ssh-keygen(1) — Linux manual page - man7.org"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://blog.csdn.net/ttyy1112/article/details/107064407",target:"_blank",rel:"noopener noreferrer"}},[a._v("PKI - 语法[ASN.1]、规范[PKCS、X.509]、编码[DER、PEM]"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://man7.org/linux/man-pages/man8/sshd.8.html#SSH_KNOWN_HOSTS_FILE_FORMAT",target:"_blank",rel:"noopener noreferrer"}},[a._v("SSH_KNOWN_HOSTS FILE FORMAT"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://blog.csdn.net/qq_26400953/article/details/105145103",target:"_blank",rel:"noopener noreferrer"}},[a._v("一文读懂authorized_keys和known_hosts_游语的博客-CSDN博客"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://blog.csdn.net/guoke312/article/details/113563911",target:"_blank",rel:"noopener noreferrer"}},[a._v("SSH known_hosts / authorized_keys 的解释 - CSDN"),s("OutboundLink")],1)]),a._v(" "),s("Vssue",{attrs:{title:"ssh-keygen"}})],1)}),[],!1,null,null,null);s.default=r.exports}}]);