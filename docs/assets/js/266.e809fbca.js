(window.webpackJsonp=window.webpackJsonp||[]).push([[266],{601:function(t,s,a){"use strict";a.r(s);var n=a(12),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"_1-命令简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-命令简介"}},[t._v("#")]),t._v(" 1.命令简介")]),t._v(" "),s("p",[t._v("pmap（process memory map）用于查看进程的内存映射，即进程的内存地址空间。")]),t._v(" "),s("p",[t._v("pmap 从文件 "),s("code",[t._v("/proc/<pid>/maps")]),t._v(" 中获得相关数据，用来观察系统中的指定进程的地址空间分布和内存状态信息，包括进程各个段的大小。对查看完整的进程地址空间很有帮助。")]),t._v(" "),s("h2",{attrs:{id:"_2-命令格式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-命令格式"}},[t._v("#")]),t._v(" 2.命令格式")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v(" pmap [options] pid [...]\n")])])]),s("h2",{attrs:{id:"_3-选项说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-选项说明"}},[t._v("#")]),t._v(" 3.选项说明")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("-x, --extended\n\t显示扩展格式。\n-d, --device\n\t显示设备格式。\n-q, --quiet\n\t不显示某些页眉或页脚行。\n-A, --range <low>,<high>\n\t将结果限制在给定范围内的低地址和高地址。\n-X\n\t显示比 -x 选项更多的细节。 警告：根据 /proc/PID/smaps 改变格式。\n-XX\n\t显示内核提供的所有内容。\n-p, --show-path\n\t在映射列中显示文件的完整路径。\n-c, --read-rc\n\t读取默认配置。\n-C, --read-rc-from <file>\n\t从指定文件读取配置。\n-n, --create-rc\n\t创建新的默认配置。\n-N, --create-rc-to file\n\t创建新配置到指定文件。\n-h, --help\n\t现实帮助信息并退出。\n-V, --version\n\t显示版本信息并退出。\n")])])]),s("p",[t._v("关于扩展格式和设备格式域的说明如下：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Address:  start address of map  映射起始地址。\nKbytes:  size of map in kilobytes  映射大小（KB）。\nRSS:  resident set size in kilobytes  驻留集大小。\nDirty:  dirty pages (both shared and private) in kilobytes  脏页大小。\nMode:  permissions on map 映像权限: r=read, w=write, x=execute, s=shared, p=private (copy on write)。\nMapping:  file backing the map , or '[ anon ]' for allocated memory, or '[ stack ]' for the program stack. 占用内存的文件，[anon] 为已分配内存，[stack] 为程序栈。\nOffset:  offset into the file 文件偏移。\nDevice:  device name (major:minor)  设备名。\n")])])]),s("h2",{attrs:{id:"_4-常用示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-常用示例"}},[t._v("#")]),t._v(" 4.常用示例")]),t._v(" "),s("p",[t._v("（1）查看进程 1 的设备格式。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# pmap -d 1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(":  init "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nAddress   Kbytes\tMode \tOffset      \t\tDevice  \tMapping\n00934000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("88")]),t._v("\t\tr-x-- \t0000000000000000 \t008:00005 \tld-2.3.4.so\n0094a000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" \t\tr---- \t0000000000015000 \t008:00005 \tld-2.3.4.so\n0094b000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" \t\trw--- \t0000000000016000 \t008:00005 \tld-2.3.4.so\n0094e000  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1188")]),t._v(" \t\tr-x-- \t0000000000000000 \t008:00005 \tlibc-2.3.4.so\n00a77000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" \t\tr---- \t0000000000129000 \t008:00005\tlibc-2.3.4.so\n00a79000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" \t\trw--- \t000000000012b000 \t008:00005\tlibc-2.3.4.so\n00a7b000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\t\trw---\t0000000000a7b000 \t000:00000  \t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" anon "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n00a85000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("52")]),t._v("\t\tr-x-- \t0000000000000000\t008:00005\tlibsepol.so.1\n00a92000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\t\trw--- \t000000000000c000\t008:00005\tlibsepol.so.1\n00a93000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),t._v("\t\trw--- \t0000000000a93000\t000:00000 \t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" anon "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n00d9d000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("52")]),t._v(" \t\tr-x--\t0000000000000000\t008:00005\tlibselinux.so.1\n00daa000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" \t\trw---\t000000000000d000\t008:00005\tlibselinux.so.1\n08048000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),t._v("\t\tr-x--\t0000000000000000\t008:00005\tinit\n0804f000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\t\trw---\t0000000000007000\t008:00005\tinit\n084e1000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("132")]),t._v("\t\trw---\t00000000084e1000\t000:00000\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" anon "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nb7f5d000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" \t\trw---\t00000000b7f5d000\t000:00000\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" anon "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nbffee000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("72")]),t._v("\t\trw---\t00000000bffee000\t000:00000 \t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" stack "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nffffe000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\t\t-----\t0000000000000000\t000:00000 \t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" anon "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nmapped: 1700K  writeable/private: 276K  shared: 0K\n")])])]),s("p",[t._v("最后一行的值：")]),t._v(" "),s("ul",[s("li",[t._v("mapped 表示该进程映射的虚拟地址空间大小，也就是该进程预先分配的虚拟内存大小，即 ps 出的 vsz。")]),t._v(" "),s("li",[t._v("writeable/private 表示进程所占用的私有地址空间大小，也就是该进程实际使用的内存大小。")]),t._v(" "),s("li",[t._v("shared 表示进程和其他进程共享的内存大小。")])]),t._v(" "),s("p",[t._v("（2）查看进程 1 的设备格式，不显示头尾行。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# pmap -d -q 1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(":  init "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n00934000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("88")]),t._v("\t\tr-x-- \t0000000000000000 \t008:00005 \tld-2.3.4.so\n0094a000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" \t\tr---- \t0000000000015000 \t008:00005 \tld-2.3.4.so\n0094b000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" \t\trw--- \t0000000000016000 \t008:00005 \tld-2.3.4.so\n0094e000  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1188")]),t._v(" \t\tr-x-- \t0000000000000000 \t008:00005 \tlibc-2.3.4.so\n00a77000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" \t\tr---- \t0000000000129000 \t008:00005\tlibc-2.3.4.so\n00a79000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" \t\trw--- \t000000000012b000 \t008:00005\tlibc-2.3.4.so\n00a7b000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\t\trw---\t0000000000a7b000 \t000:00000  \t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" anon "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n00a85000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("52")]),t._v("\t\tr-x-- \t0000000000000000\t008:00005\tlibsepol.so.1\n00a92000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\t\trw--- \t000000000000c000\t008:00005\tlibsepol.so.1\n00a93000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),t._v("\t\trw--- \t0000000000a93000\t000:00000 \t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" anon "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n00d9d000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("52")]),t._v(" \t\tr-x--\t0000000000000000\t008:00005\tlibselinux.so.1\n00daa000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" \t\trw---\t000000000000d000\t008:00005\tlibselinux.so.1\n08048000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),t._v("\t\tr-x--\t0000000000000000\t008:00005\tinit\n0804f000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\t\trw---\t0000000000007000\t008:00005\tinit\n084e1000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("132")]),t._v("\t\trw---\t00000000084e1000\t000:00000\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" anon "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nb7f5d000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" \t\trw---\t00000000b7f5d000\t000:00000\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" anon "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nbffee000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("72")]),t._v("\t\trw---\t00000000bffee000\t000:00000 \t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" stack "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nffffe000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\t\t-----\t0000000000000000\t000:00000 \t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" anon "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("p",[t._v("（3） 查看进程 1 的扩展格式。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# pmap -x 1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(":  init "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("          \nAddress  Kbytes\t\tRSS  Anon Locked\tMode  Mapping\n00934000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("88")]),t._v("    \t-    -    -\t\t\tr-x-- ld-2.3.4.so\n0094a000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\t\t-    -    - \t\tr---- ld-2.3.4.so\n0094b000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\t\t-    -    -\t\t\trw--- ld-2.3.4.so\n0094e000  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1188")]),t._v("\t\t-    -    -\t\t\tr-x-- libc-2.3.4.so\n00a77000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("    -    -    -\t\t\tr---- libc-2.3.4.so\n00a79000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("    -    -    -\t\t\trw--- libc-2.3.4.so\n00a7b000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("    -    -    -\t\t\trw--- "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" anon "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n00a85000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("52")]),t._v("    -    -    -\t\t\tr-x-- libsepol.so.1\n00a92000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("    -    -    -\t\t\trw--- libsepol.so.1\n00a93000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),t._v("    -    -    -\t\t\trw--- "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" anon "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n00d9d000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("52")]),t._v("    -    -    -\t\t\tr-x-- libselinux.so.1\n00daa000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("    -    -    -\t\t\trw--- libselinux.so.1\n08048000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),t._v("    -    -    -\t\t\tr-x-- init\n0804f000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("    -    -    -\t\t\trw--- init\n084e1000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("132")]),t._v("    -    -    -\t\t\trw--- "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" anon "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nb7f5d000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("    -    -    -\t\t\trw--- "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" anon "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nbffee000   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("72")]),t._v("    -    -    -\t\t\trw--- "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" stack "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nffffe000    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("    -    -    -\t\t\t----- "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" anon "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n-------- ------- ------- ------- -------\ntotal kB  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1700")]),t._v("    -    -    -\n")])])]),s("p",[t._v("（4）循环显示进程 3066 的设备格式的最后 1 行，间隔 3 秒。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# while true; do pmap -d 3066 | tail -1; sleep 2; done")]),t._v("\nmapped: 5412K  writeable/private: 2028K  shared: 0K\nmapped: 5412K  writeable/private: 2028K  shared: 0K\nmapped: 5412K  writeable/private: 2028K  shared: 0K\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])]),s("hr"),t._v(" "),s("h2",{attrs:{id:"参考文献"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考文献"}},[t._v("#")]),t._v(" 参考文献")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://man7.org/linux/man-pages/man1/pmap.1.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("pmap(1) - Linux manual page - man7.org"),s("OutboundLink")],1)]),t._v(" "),s("Vssue",{attrs:{title:"pmap"}})],1)}),[],!1,null,null,null);s.default=e.exports}}]);